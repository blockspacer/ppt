| Offset            | Instr                         | Origin          |
|-------------------+-------------------------------+-----------------|
| 0x080484f0 <+0>   | push   %ebp                   | prologue        |
| 0x080484f1 <+1>   | push   %ebx                   |                 |
| 0x080484f2 <+2>   | push   %edi                   |                 |
| 0x080484f3 <+3>   | push   %esi                   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080484f4 <+4>   | sub    $0x3c,%esp             | head            |
| 0x080484f7 <+7>   | cmpl   $0x2,0x50(%esp)        |                 |
| 0x080484fc <+12>  | jl     0x80486cb <main+475>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048502 <+18>  | mov    0x54(%esp),%esi        | load_args       |
| 0x08048506 <+22>  | mov    0x8(%esi),%eax         |                 |
| 0x08048509 <+25>  | mov    0xc(%esi),%edi         |                 |
| 0x0804850c <+28>  | mov    %eax,0x18(%esp)        |                 |
| 0x08048510 <+32>  | mov    %eax,(%esp)            |                 |
| 0x08048513 <+35>  | call   0x8048408 <atoi@plt>   |                 |
| 0x08048518 <+40>  | mov    %eax,%ebx              |                 |
| 0x0804851a <+42>  | mov    %edi,(%esp)            |                 |
| 0x0804851d <+45>  | call   0x8048408 <atoi@plt>   |                 |
| 0x08048522 <+50>  | mov    %eax,0x14(%esp)        |                 |
| 0x08048526 <+54>  | test   %eax,%eax              |                 |
| 0x08048528 <+56>  | jle    0x80486cb <main+475>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804852e <+62>  | mov    0x4(%esi),%eax         | try_fopen       |
| 0x08048531 <+65>  | mov    %eax,0x18(%esp)        |                 |
| 0x08048535 <+69>  | mov    %eax,(%esp)            |                 |
| 0x08048538 <+72>  | movl   $0x80487d0,0x4(%esp)   |                 |
| 0x08048540 <+80>  | call   0x80483f8 <fopen@plt>  |                 |
| 0x08048545 <+85>  | mov    %eax,%esi              |                 |
| 0x08048547 <+87>  | test   %esi,%esi              |                 |
| 0x08048549 <+89>  | je     0x80486bf <main+463>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804854f <+95>  | mov    %ebx,(%esp)            | try_shmat       |
| 0x08048552 <+98>  | movl   $0x100,0x8(%esp)       |                 |
| 0x0804855a <+106> | movl   $0x0,0x4(%esp)         |                 |
| 0x08048562 <+114> | call   0x80483b8 <shmat@plt>  |                 |
| 0x08048567 <+119> | test   %eax,%eax              |                 |
| 0x08048569 <+121> | je     0x80486bf <main+463>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804856f <+127> | mov    %eax,0x20(%esp)        | init_vars       |
| 0x08048573 <+131> | mov    %eax,0x1c(%esp)        |                 |
| 0x08048577 <+135> | mov    0x14(%esp),%ecx        |                 |
| 0x0804857b <+139> | mov    %ecx,%edi              |                 |
| 0x0804857d <+141> | shl    $0x4,%edi              |                 |
| 0x08048580 <+144> | add    %eax,%edi              |                 |
| 0x08048582 <+146> | movl   $0x0,0x30(%esp)        |                 |
| 0x0804858a <+154> | movl   $0x0,0x2c(%esp)        |                 |
| 0x08048592 <+162> | movl   $0x186a0,0x28(%esp)    |                 |
| 0x0804859a <+170> | movl   $0x0,0x38(%esp)        |                 |
| 0x080485a2 <+178> | lea    0x0(,%ecx,4),%ebx      |                 |
| 0x080485a9 <+185> | jmp    0x804865f <main+367>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080485ae <+190> | xchg   %ax,%ax                | accept_frame    |
| 0x080485b0 <+192> | incl   0x38(%esp)             |                 |
| 0x080485b4 <+196> | incl   0x34(%esp)             |                 |
| 0x080485b8 <+200> | mov    0x20(%esp),%eax        |                 |
| 0x080485bc <+204> | mov    (%eax),%ecx            |                 |
| 0x080485be <+206> | mov    %ecx,0x30(%esp)        |                 |
| 0x080485c2 <+210> | add    $0x10,%eax             |                 |
| 0x080485c5 <+213> | mov    %eax,0x20(%esp)        |                 |
| 0x080485c9 <+217> | cmp    %edi,%eax              |                 |
| 0x080485cb <+219> | jne    0x8048670 <main+384>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080485d1 <+225> | mov    0x1c(%esp),%eax        | write_buffer    |
| 0x080485d5 <+229> | mov    0x38(%esp),%ecx        |                 |
| 0x080485d9 <+233> | mov    %esi,0xc(%esp)         |                 |
| 0x080485dd <+237> | mov    %ecx,0x4(%esp)         |                 |
| 0x080485e1 <+241> | mov    %eax,(%esp)            |                 |
| 0x080485e4 <+244> | movl   $0x10,0x8(%esp)        |                 |
| 0x080485ec <+252> | call   0x8048418 <fwrite@plt> |                 |
| 0x080485f1 <+257> | mov    0x20(%esp),%eax        |                 |
| 0x080485f5 <+261> | mov    %eax,0x1c(%esp)        |                 |
| 0x080485f9 <+265> | movl   $0x0,0x38(%esp)        |                 |
| 0x08048601 <+273> | cmpl   $0x0,0x24(%esp)        |                 |
| 0x08048606 <+278> | jne    0x8048670 <main+384>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048608 <+280> | mov    0x34(%esp),%ecx        | finish_read     |
| 0x0804860c <+284> | mov    %ecx,%eax              |                 |
| 0x0804860e <+286> | mov    0x14(%esp),%edx        |                 |
| 0x08048612 <+290> | sub    %edx,%eax              |                 |
| 0x08048614 <+292> | sar    $0x3,%edx              |                 |
| 0x08048617 <+295> | cmp    %edx,%eax              |                 |
| 0x08048619 <+297> | jle    0x8048622 <main+306>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804861b <+299> | imul   $0x7,%edx,%edx         | finish_read2    |
| 0x0804861e <+302> | cmp    %edx,%eax              |                 |
| 0x08048620 <+304> | jl     0x804864f <main+351>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048622 <+306> | mov    0x14(%esp),%eax        | recalc          |
| 0x08048626 <+310> | imul   0x28(%esp),%eax        |                 |
| 0x0804862b <+315> | add    %ecx,%ecx              |                 |
| 0x0804862d <+317> | xor    %edx,%edx              |                 |
| 0x0804862f <+319> | div    %ecx                   |                 |
| 0x08048631 <+321> | cmp    $0x1e8481,%eax         |                 |
| 0x08048636 <+326> | mov    $0x1e8480,%ecx         |                 |
| 0x0804863b <+331> | cmovge %ecx,%eax              |                 |
| 0x0804863e <+334> | cmp    $0x1869f,%eax          |                 |
| 0x08048643 <+339> | mov    $0x186a0,%ecx          |                 |
| 0x08048648 <+344> | cmovle %ecx,%eax              |                 |
| 0x0804864b <+347> | mov    %eax,0x28(%esp)        |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804864f <+351> | mov    0x28(%esp),%ebp        | do_sleep        |
| 0x08048653 <+355> | mov    %ebp,(%esp)            |                 |
| 0x08048656 <+358> | call   0x80483e8 <usleep@plt> |                 |
| 0x0804865b <+363> | test   %ebp,%ebp              |                 |
| 0x0804865d <+365> | je     0x80486cb <main+475>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804865f <+367> | movl   $0x0,0x34(%esp)        | sleep_loop_head |
| 0x08048667 <+375> | movl   $0x1,0x24(%esp)        |                 |
| 0x0804866f <+383> | nop                           |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048670 <+384> | mov    0x30(%esp),%eax        | read_loop_head  |
| 0x08048674 <+388> | mov    0x20(%esp),%ecx        |                 |
| 0x08048678 <+392> | cmp    %eax,(%ecx)            |                 |
| 0x0804867a <+394> | jae    0x80485b0 <main+192>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048680 <+400> | mov    0x30(%esp),%eax        | read_loop_head2 |
| 0x08048684 <+404> | sub    %ebx,%eax              |                 |
| 0x08048686 <+406> | mov    %eax,%ecx              |                 |
| 0x08048688 <+408> | sar    $0x1f,%ecx             |                 |
| 0x0804868b <+411> | and    %eax,%ecx              |                 |
| 0x0804868d <+413> | mov    0x20(%esp),%eax        |                 |
| 0x08048691 <+417> | cmp    %ecx,(%eax)            |                 |
| 0x08048693 <+419> | jbe    0x80485b0 <main+192>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048699 <+425> | cmpl   $0x0,0x34(%esp)        | read_loop_head2 |
| 0x0804869e <+430> | jne    0x80486b2 <main+450>   |                 |
| 0x080486a0 <+432> | mov    0x20(%esp),%eax        |                 |
| 0x080486a4 <+436> | mov    (%eax),%eax            |                 |
| 0x080486a6 <+438> | mov    0x30(%esp),%ecx        |                 |
| 0x080486aa <+442> | cmp    %ecx,%eax              |                 |
| 0x080486ac <+444> | jne    0x80485b0 <main+192>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080486b2 <+450> | movl   $0x0,0x24(%esp)        | failed_read     |
| 0x080486ba <+458> | jmp    0x80485d1 <main+225>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080486bf <+463> | mov    0x18(%esp),%eax        | p_error         |
| 0x080486c3 <+467> | mov    %eax,(%esp)            |                 |
| 0x080486c6 <+470> | call   0x80483d8 <perror@plt> |                 |
|-------------------+-------------------------------+-----------------|
| 0x080486cb <+475> | mov    $0x1,%eax              | exit            |
| 0x080486d0 <+480> | add    $0x3c,%esp             |                 |
| 0x080486d3 <+483> | pop    %esi                   | epilogue        |
| 0x080486d4 <+484> | pop    %edi                   |                 |
| 0x080486d5 <+485> | pop    %ebx                   |                 |
| 0x080486d6 <+486> | pop    %ebp                   |                 |
| 0x080486d7 <+487> | ret                           |                 |
|                   |                               |                 |

 
Addresses
0x38(esp) v_stride
0x34(esp) v_count
0x30(esp) v_seqno
0x2c(esp) v_last_seqno
0x28(esp) v_delay
0x24(esp) v_cont_read
0x20(esp) v_p_cur
0x1c(esp) v_p_stride
0x18(esp) v_p_error

-- single run notes
shmat's retval (array_start) = b7fde000
$esi gets array_start       at b7fde000
%edi gets array_end,        at b7fde080


-----------------------------------------------------------------------

| Address           | Instruction                   | Block           |
|-------------------+-------------------------------+-----------------|
| 0x080484f0 <+0>   | push   %ebx                   | - Init -        |
| 0x080484f1 <+1>   | push   %edi                   |                 |
| 0x080484f2 <+2>   | push   %esi                   |                 |
| 0x080484f3 <+3>   | sub    $0x40,%esp             |                 |
| 0x080484f6 <+6>   | cmpl   $0x3,0x50(%esp)        |                 |
| 0x080484fb <+11>  | jl     0x80486fd <main+525>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048501 <+17>  | mov    0x54(%esp),%esi        | load_args       |
| 0x08048505 <+21>  | mov    0x8(%esi),%eax         |                 |
| 0x08048508 <+24>  | mov    0xc(%esi),%edi         |                 |
| 0x0804850b <+27>  | mov    %eax,0x1c(%esp)        |                 |
| 0x0804850f <+31>  | mov    %eax,(%esp)            |                 |
| 0x08048512 <+34>  | call   0x8048408 <atoi@plt>   |                 |
| 0x08048517 <+39>  | mov    %eax,%ebx              |                 |
| 0x08048519 <+41>  | mov    %edi,(%esp)            |                 |
| 0x0804851c <+44>  | call   0x8048408 <atoi@plt>   |                 |
| 0x08048521 <+49>  | mov    %eax,0x10(%esp)        |                 |
| 0x08048525 <+53>  | test   %eax,%eax              |                 |
| 0x08048527 <+55>  | jle    0x80486fd <main+525>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804852d <+61>  | mov    0x4(%esi),%eax         | try_fopen       |
| 0x08048530 <+64>  | mov    %eax,0x1c(%esp)        |                 |
| 0x08048534 <+68>  | mov    %eax,(%esp)            |                 |
| 0x08048537 <+71>  | movl   $0x8048800,0x4(%esp)   |                 |
| 0x0804853f <+79>  | call   0x80483f8 <fopen@plt>  |                 |
| 0x08048544 <+84>  | mov    %eax,0x18(%esp)        |                 |
| 0x08048548 <+88>  | test   %eax,%eax              |                 |
| 0x0804854a <+90>  | je     0x80486f1 <main+513>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048550 <+96>  | mov    %ebx,(%esp)            | try_shmat       |
| 0x08048553 <+99>  | movl   $0x100,0x8(%esp)       |                 |
| 0x0804855b <+107> | movl   $0x0,0x4(%esp)         |                 |
| 0x08048563 <+115> | call   0x80483b8 <shmat@plt>  |                 |
| 0x08048568 <+120> | test   %eax,%eax              |                 |
| 0x0804856a <+122> | je     0x80486f1 <main+513>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048570 <+128> | mov    %eax,0x14(%esp)        | init_vars       |
| 0x08048574 <+132> | mov    %eax,0x24(%esp)        |                 |
| 0x08048578 <+136> | mov    %eax,0x20(%esp)        |                 |
| 0x0804857c <+140> | mov    0x10(%esp),%ecx        |                 |
| 0x08048580 <+144> | mov    %ecx,%esi              |                 |
| 0x08048582 <+146> | shl    $0x4,%esi              |                 |
| 0x08048585 <+149> | add    %eax,%esi              |                 |
| 0x08048587 <+151> | movl   $0x0,0x34(%esp)        |                 |
| 0x0804858f <+159> | movl   $0x0,0x30(%esp)        |                 |
| 0x08048597 <+167> | movl   $0x186a0,0x2c(%esp)    |                 |
| 0x0804859f <+175> | movl   $0x0,0x3c(%esp)        |                 |
| 0x080485a7 <+183> | lea    0x0(,%ecx,4),%edi      |                 |
| 0x080485ae <+190> | jmp    0x804867f <main+399>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080485b3 <+195> | lea    0x0(%esi),%esi         | inst. pad?      |
| 0x080485b9 <+201> | lea    0x0(%edi,%eiz,1),%edi  |                 |
|-------------------+-------------------------------+-----------------|
| 0x080485c0 <+208> | incl   0x3c(%esp)             | accept_frame    |
| 0x080485c4 <+212> | incl   0x38(%esp)             |                 |
| 0x080485c8 <+216> | mov    0x24(%esp),%eax        |                 |
| 0x080485cc <+220> | mov    (%eax),%ecx            |                 |
| 0x080485ce <+222> | mov    %ecx,0x34(%esp)        |                 |
| 0x080485d2 <+226> | add    $0x10,%eax             |                 |
| 0x080485d5 <+229> | mov    %eax,0x24(%esp)        |                 |
| 0x080485d9 <+233> | cmp    %esi,%eax              |                 |
| 0x080485db <+235> | jne    0x8048690 <main+416>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080485e1 <+241> | mov    0x14(%esp),%eax        | back_to_front   |
| 0x080485e5 <+245> | mov    %eax,0x24(%esp)        |                 |
|-------------------+-------------------------------+-----------------|
| 0x080485e9 <+249> | mov    0x20(%esp),%eax        | write_buffer    |
| 0x080485ed <+253> | mov    0x3c(%esp),%ecx        |                 |
| 0x080485f1 <+257> | mov    0x18(%esp),%ebx        |                 |
| 0x080485f5 <+261> | mov    %ebx,0xc(%esp)         |                 |
| 0x080485f9 <+265> | mov    %ecx,0x4(%esp)         |                 |
| 0x080485fd <+269> | mov    %eax,(%esp)            |                 |
| 0x08048600 <+272> | movl   $0x10,0x8(%esp)        |                 |
| 0x08048608 <+280> | call   0x8048418 <fwrite@plt> |                 |
| 0x0804860d <+285> | mov    0x24(%esp),%eax        |                 |
| 0x08048611 <+289> | mov    %eax,0x20(%esp)        |                 |
| 0x08048615 <+293> | movl   $0x0,0x3c(%esp)        |                 |
| 0x0804861d <+301> | cmpl   $0x0,0x28(%esp)        |                 |
| 0x08048622 <+306> | jne    0x8048690 <main+416>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048624 <+308> | mov    0x38(%esp),%ecx        | finish_read     |
| 0x08048628 <+312> | mov    %ecx,%eax              |                 |
| 0x0804862a <+314> | mov    0x10(%esp),%edx        |                 |
| 0x0804862e <+318> | sub    %edx,%eax              |                 |
| 0x08048630 <+320> | sar    $0x3,%edx              |                 |
| 0x08048633 <+323> | cmp    %edx,%eax              |                 |
| 0x08048635 <+325> | jle    0x804863e <main+334>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048637 <+327> | imul   $0x7,%edx,%edx         | finish_read_2   |
| 0x0804863a <+330> | cmp    %edx,%eax              |                 |
| 0x0804863c <+332> | jl     0x804866b <main+379>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804863e <+334> | mov    0x10(%esp),%eax        | recalc          |
| 0x08048642 <+338> | imul   0x2c(%esp),%eax        |                 |
| 0x08048647 <+343> | add    %ecx,%ecx              |                 |
| 0x08048649 <+345> | xor    %edx,%edx              |                 |
| 0x0804864b <+347> | div    %ecx                   |                 |
| 0x0804864d <+349> | cmp    $0x1e8481,%eax         |                 |
| 0x08048652 <+354> | mov    $0x1e8480,%ecx         |                 |
| 0x08048657 <+359> | cmovge %ecx,%eax              |                 |
| 0x0804865a <+362> | cmp    $0x1869f,%eax          |                 |
| 0x0804865f <+367> | mov    $0x186a0,%ecx          |                 |
| 0x08048664 <+372> | cmovle %ecx,%eax              |                 |
| 0x08048667 <+375> | mov    %eax,0x2c(%esp)        |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804866b <+379> | mov    0x2c(%esp),%ebx        | do_sleep        |
| 0x0804866f <+383> | mov    %ebx,(%esp)            |                 |
| 0x08048672 <+386> | call   0x80483e8 <usleep@plt> |                 |
| 0x08048677 <+391> | test   %ebx,%ebx              |                 |
| 0x08048679 <+393> | je     0x80486fd <main+525>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x0804867f <+399> | movl   $0x0,0x38(%esp)        | sleep_loop_head |
| 0x08048687 <+407> | movl   $0x1,0x28(%esp)        |                 |
| 0x0804868f <+415> | nop                           |                 |
|-------------------+-------------------------------+-----------------|
| 0x08048690 <+416> | mov    0x34(%esp),%eax        | read_loop_head  |
| 0x08048694 <+420> | mov    0x24(%esp),%ecx        |                 |
| 0x08048698 <+424> | cmp    %eax,(%ecx)            |                 |
| 0x0804869a <+426> | jae    0x80485c0 <main+208>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080486a0 <+432> | mov    0x24(%esp),%eax        | read_loop_head2 |
| 0x080486a4 <+436> | movd   (%eax),%xmm0           |                 |
| 0x080486a8 <+440> | movsd  0x80487d8,%xmm1        |                 |
| 0x080486b0 <+448> | orps   %xmm1,%xmm0            |                 |
| 0x080486b3 <+451> | subsd  %xmm1,%xmm0            |                 |
| 0x080486b7 <+455> | mov    0x34(%esp),%eax        |                 |
| 0x080486bb <+459> | sub    %edi,%eax              |                 |
| 0x080486bd <+461> | cvtsi2sd %eax,%xmm1           |                 |
| 0x080486c1 <+465> | ucomisd %xmm0,%xmm1           |                 |
| 0x080486c5 <+469> | jae    0x80485c0 <main+208>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080486cb <+475> | cmpl   $0x0,0x38(%esp)        | read_loop_head3 |
| 0x080486d0 <+480> | jne    0x80486e4 <main+500>   |                 |
| 0x080486d2 <+482> | mov    0x24(%esp),%eax        |                 |
| 0x080486d6 <+486> | mov    (%eax),%eax            |                 |
| 0x080486d8 <+488> | mov    0x34(%esp),%ecx        |                 |
| 0x080486dc <+492> | cmp    %ecx,%eax              |                 |
| 0x080486de <+494> | jne    0x80485c0 <main+208>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080486e4 <+500> | movl   $0x0,0x28(%esp)        | failed_read     |
| 0x080486ec <+508> | jmp    0x80485e9 <main+249>   |                 |
|-------------------+-------------------------------+-----------------|
| 0x080486f1 <+513> | mov    0x1c(%esp),%eax        | p_exit          |
| 0x080486f5 <+517> | mov    %eax,(%esp)            |                 |
| 0x080486f8 <+520> | call   0x80483d8 <perror@plt> |                 |
|-------------------+-------------------------------+-----------------|
| 0x080486fd <+525> | mov    $0x1,%eax              | exit            |
| 0x08048702 <+530> | add    $0x40,%esp             |                 |
| 0x08048705 <+533> | pop    %esi                   |                 |
| 0x08048706 <+534> | pop    %edi                   |                 |
| 0x08048707 <+535> | pop    %ebx                   |                 |
| 0x08048708 <+536> | ret                           |                 |


LAYOUT
| p_cur        | 0x24(esp) |
| p_stride     | 0x20(esp) |
| array_start  | 0x14(esp) |
| array_end    | $esi      |
| array_length | 0x10(esp) |
| v_count      | 0x38(esp) |
| v_cont_read  | 0x28(esp) |
| v_stride     | 0x3c(esp) |
| v_seqno      | 0x34(esp) |
| v_last_seqno |           |
